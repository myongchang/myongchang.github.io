(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     47668,       1236]
NotebookOptionsPosition[     44304,       1122]
NotebookOutlinePosition[     46171,       1183]
CellTagsIndexPosition[     46128,       1180]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Vaxx Project: Source Code for the Benchmark Experiments (1 and 2)\
\>", "Chapter",
 CellChangeTimes->{{3.6635983262715507`*^9, 3.6635983427111945`*^9}, {
  3.6637665613191195`*^9, 3.66376656866754*^9}, {3.664032824719085*^9, 
  3.6640328438309965`*^9}, {3.664304296335039*^9, 3.6643042997263784`*^9}, {
  3.666454072343207*^9, 3.6664540889748697`*^9}, {3.705748449473796*^9, 
  3.7057484546988406`*^9}, {3.7090396152255387`*^9, 3.7090396183167157`*^9}, {
  3.7265839239696913`*^9, 3.7265839405943537`*^9}, {3.726586347967081*^9, 
  3.726586389945278*^9}}],

Cell["Code created by: Myong-Hun Chang (initial date: 7/14/2017)", "Text",
 CellChangeTimes->{{3.6561721887638693`*^9, 3.6561722008918695`*^9}, {
  3.663598351880111*^9, 3.6635983639203153`*^9}, {3.6643043089032955`*^9, 
  3.664304309367342*^9}, {3.666454095015474*^9, 3.6664540977757497`*^9}, {
  3.701776424401745*^9, 3.701776435465745*^9}, {3.709039628117276*^9, 
  3.7090396400049562`*^9}},
 Background->RGBColor[0.87, 0.94, 1]],

Cell[TextData[StyleBox["This code is intended for private research and not \
for public use. As such, the code is specifically designed for the narrow set \
of research questions and not for mass consumption. The author will provide \
no support, no help debugging, and no evaluation of model output.",
 Background->RGBColor[0.87, 0.94, 1]]], "Text",
 CellChangeTimes->{{3.7265862664730387`*^9, 3.7265863337346573`*^9}}],

Cell[CellGroupData[{

Cell["Directory", "Section",
 CellChangeTimes->{{3.709328278884697*^9, 3.7093282800607643`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NotebookDirectory", "[", "]"}]], "Input",
 CellChangeTimes->{{3.7093281323413153`*^9, 3.709328138405662*^9}}],

Cell[BoxData["\<\"C:\\\\MyResearchTemp\\\\Vaccination\\\\Codex\\\\\"\>"], \
"Output",
 CellChangeTimes->{3.70932815009033*^9, 3.709390762401018*^9, 
  3.7093916583262577`*^9, 3.7094736113501787`*^9, 3.7094739297866416`*^9, 
  3.709545418483456*^9, 3.709559995275303*^9, 3.7095666573830457`*^9, 
  3.7096383825496883`*^9, 3.709769302423237*^9, 3.7149213648372574`*^9, 
  3.7149217423848515`*^9, 3.714921968012757*^9, 3.715516014075124*^9, 
  3.7155237116295085`*^9, 3.715523923826646*^9, 3.725408193565821*^9, 
  3.725439077874713*^9, 3.7254684315749693`*^9, 3.725507873724658*^9, 
  3.725529735353064*^9, 3.7255606966514745`*^9, 3.725619826430993*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Functions", "Section"],

Cell[CellGroupData[{

Cell["Initialize the Population Grid", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"population", "[", 
    RowBox[{"X_", ",", "Y_"}], "]"}], ":=", "\n", 
   RowBox[{"(", "\n", 
    RowBox[{
     RowBox[{"Z", "=", 
      RowBox[{"X", "*", "Y"}]}], ";", "\n", 
     RowBox[{
      RowBox[{"toIndex", "[", 
       RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
      RowBox[{"n", "-", "1", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"m", "-", "1"}], ")"}], "*", "X"}]}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"function", " ", "for", " ", "transforming", " ", 
       RowBox[{"(", 
        RowBox[{"n", ",", " ", "m"}], ")"}], " ", "into", " ", "a", " ", 
       "single", " ", "index", " ", "number"}], " ", "*)"}], "\n", 
     RowBox[{
      RowBox[{"toCoord", "[", "x_", "]"}], ":=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Mod", "[", 
          RowBox[{"x", ",", "X"}], "]"}], "+", "1"}], ",", 
        RowBox[{
         RowBox[{"Quotient", "[", 
          RowBox[{"x", ",", "X"}], "]"}], "+", "1"}]}], "}"}]}], ";"}], " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "function", " ", "for", " ", "transforming", " ", "an", " ", "index", 
      " ", "number", " ", "into", " ", 
      RowBox[{"(", 
       RowBox[{"n", ",", " ", "m"}], ")"}], " ", "coordinates"}], " ", "*)"}],
     "\n", ")"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.7090397752306905`*^9, 3.7090397759817333`*^9}},
 Background->RGBColor[1, 0.925, 0.925]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Create and Populate the Hubs", "Subsection",
 CellChangeTimes->{{3.709112639185646*^9, 3.709112680634017*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"hubmember", "[", 
    RowBox[{"xH_", ",", "yH_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"hub", "[", 
         RowBox[{"a", ",", "b"}], "]"}], "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"toIndex", "[", 
            RowBox[{"i", ",", "j"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"b", "-", "1"}], ")"}], "*", "yH"}], "+", "1"}], ",", 
             RowBox[{"b", "*", "yH"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"a", "-", "1"}], ")"}], "*", "xH"}], "+", "1"}], ",", 
             RowBox[{"a", "*", "xH"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"a", ",", "1", ",", 
         RowBox[{"Floor", "[", 
          RowBox[{"X", ",", "xH"}], "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"b", ",", "1", ",", 
         RowBox[{"Floor", "[", 
          RowBox[{"Y", ",", "yH"}], "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"agentHub", "[", "k", "]"}], "=", 
          RowBox[{"{", 
           RowBox[{"i", ",", "j"}], "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"k", ",", 
           RowBox[{"hub", "[", 
            RowBox[{"i", ",", "j"}], "]"}]}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Floor", "[", 
          RowBox[{"X", "/", "xH"}], "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Floor", "[", 
          RowBox[{"Y", "/", "yH"}], "]"}]}], "}"}]}], "]"}], ";"}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.709112420637146*^9, 3.7091124303617024`*^9}, {
  3.709112480129549*^9, 3.7091125555228615`*^9}, {3.709113706297682*^9, 
  3.7091137187993965`*^9}},
 Background->RGBColor[1, 0.925, 0.925]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Create Contact Networks", "Subsection",
 CellChangeTimes->{{3.709112639185646*^9, 3.709112680634017*^9}, {
  3.726584100952388*^9, 3.726584107569049*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"contact", "[", 
    RowBox[{"netSize_", ",", "pC_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"construct", " ", "hub", " ", "source"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"cntP", "[", "i", "]"}], "=", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"hub", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"agentHub", "[", "i", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"agentHub", "[", "i", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "i"}], "]"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{
          RowBox[{"X", "*", "Y"}], "-", "1"}]}], "}"}]}], "]"}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"exclude", " ", "oneself", " ", "from", " ", 
       RowBox[{"one", "'"}], "s", " ", "own", " ", "hub"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"construct", " ", "actual", " ", "network"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"cntA", "[", "i", "]"}], "=", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{
          RowBox[{"X", "*", "Y"}], "-", "1"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"avail", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"i", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{
           RowBox[{"X", "*", "Y"}], "-", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"totLen", "=", "0"}], ";", " ", 
     RowBox[{"avgLen", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"invZ", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"i", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{
           RowBox[{"X", "*", "Y"}], "-", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"avgLen", "<", "netSize"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"trial1", "=", 
         RowBox[{"RandomChoice", "[", "avail", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"indp", "=", 
         RowBox[{"RandomReal", "[", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"trial2", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"0", "\[LessEqual]", "indp", "\[LessEqual]", "pC"}], ",", 
           RowBox[{"RandomChoice", "[", 
            RowBox[{"cntP", "[", "trial1", "]"}], "]"}], ",", 
           RowBox[{"pC", "<", "indp", "\[LessEqual]", "1"}], ",", 
           RowBox[{"RandomChoice", "[", 
            RowBox[{"Complement", "[", 
             RowBox[{"invZ", ",", 
              RowBox[{"hub", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"agentHub", "[", "trial1", "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"agentHub", "[", "trial1", "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], "]"}]}], 
          "]"}]}], ";", "\n", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"FreeQ", "[", 
           RowBox[{
            RowBox[{"cntA", "[", "trial1", "]"}], ",", "trial2"}], "]"}], ",",
           "\n", 
          RowBox[{
           RowBox[{
            RowBox[{"cntA", "[", "trial1", "]"}], "=", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"cntA", "[", "trial1", "]"}], ",", 
              RowBox[{"{", "trial2", "}"}]}], "]"}]}], ";", "\n", 
           RowBox[{
            RowBox[{"cntA", "[", "trial2", "]"}], "=", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"cntA", "[", "trial2", "]"}], ",", 
              RowBox[{"{", "trial1", "}"}]}], "]"}]}], ";", "\n", 
           RowBox[{"totLen", "=", 
            RowBox[{"totLen", "+", "2"}]}], ";", "\n", 
           RowBox[{"avgLen", "=", 
            RowBox[{"totLen", "/", 
             RowBox[{"(", 
              RowBox[{"X", "*", "Y"}], ")"}]}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";"}], "\[IndentingNewLine]", ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7091138432855167`*^9, 3.709113924778178*^9}, {
  3.7091139597461777`*^9, 3.709114043457966*^9}, {3.709114085394365*^9, 
  3.709114085714383*^9}, {3.709114137378338*^9, 3.7091144319141846`*^9}, {
  3.709114550433964*^9, 3.7091146245142007`*^9}, {3.7091146641454673`*^9, 
  3.709114712302222*^9}, {3.709114742633957*^9, 3.709114752674531*^9}, {
  3.709114865760398*^9, 3.70911499720601*^9}, {3.7091150300343084`*^9, 
  3.7091151162853775`*^9}, {3.7091173400665927`*^9, 3.7091173432467747`*^9}, {
  3.7091176016025515`*^9, 3.7091176405417786`*^9}},
 Background->RGBColor[1, 0.925, 0.925]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Parameters", "Section",
 CellChangeTimes->{{3.7091167533860364`*^9, 3.7091167577702875`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"X", "=", "100"}], ";", 
   RowBox[{"Y", "=", "100"}], ";", 
   RowBox[{"xH", "=", "10"}], ";", 
   RowBox[{"yH", "=", "10"}], ";", 
   RowBox[{"netSize", "=", "20"}], ";", 
   RowBox[{"nseed", "=", "10"}], ";", " ", 
   RowBox[{"pC", "=", "0.95"}], ";"}], " "}]], "Input",
 CellChangeTimes->{{3.709116452519828*^9, 3.709116494498229*^9}, {
   3.709117861930442*^9, 3.7091178625374765`*^9}, {3.709120401659623*^9, 
   3.709120404008231*^9}, {3.7091204460731645`*^9, 3.7091204480047703`*^9}, {
   3.7091204972707214`*^9, 3.7091204980687237`*^9}, {3.7094729225801783`*^9, 
   3.7094729411971784`*^9}, {3.7094736291161785`*^9, 3.7094736295481787`*^9}, 
   3.709559635428227*^9, 3.7095666795620456`*^9, 3.7096372483281083`*^9, {
   3.7097679437549677`*^9, 3.7097679488249764`*^9}, 3.709768314353219*^9, 
   3.7097683696085157`*^9, {3.7149208354969807`*^9, 3.7149208503928328`*^9}, {
   3.7149213820812435`*^9, 3.7149213824972672`*^9}, {3.7149218310249214`*^9, 
   3.7149218388173676`*^9}, {3.7155233025301094`*^9, 3.7155233089314756`*^9}, 
   3.725438286102115*^9, {3.7254682829297066`*^9, 3.7254682853945103`*^9}, {
   3.725507700645153*^9, 3.725507702361156*^9}, {3.725529627712875*^9, 
   3.7255296283212757`*^9}, {3.7255594533628883`*^9, 3.725559458323697*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Population and the Hub Membership", "Section",
 CellChangeTimes->{{3.7091167648976946`*^9, 3.709116765081705*^9}, {
  3.7091168663935003`*^9, 3.709116872769865*^9}, {3.70911842494127*^9, 
  3.709118436970706*^9}, {3.7094727819242687`*^9, 3.7094728100700827`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"population", "[", 
   RowBox[{"X", ",", "Y"}], "]"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"create", " ", "the", " ", "population"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.709115187915604*^9, 3.7091151946734247`*^9}, {
  3.709116504585806*^9, 3.7091165085780344`*^9}, {3.727629452194649*^9, 
  3.727629463553649*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"hubmember", "[", 
   RowBox[{"xH", ",", "yH"}], "]"}], ";", "  ", 
  RowBox[{"(*", " ", 
   RowBox[{"specify", " ", "the", " ", "hub", " ", "membership"}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.7091152008642473`*^9, 3.7091152069028683`*^9}, {
  3.709116513307305*^9, 3.70911651760155*^9}, {3.727629467433649*^9, 
  3.727629478096649*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Epidemics", "Section",
 CellChangeTimes->{{3.7091167648976946`*^9, 3.709116765081705*^9}, {
   3.7091168663935003`*^9, 3.709116872769865*^9}, {3.70911842494127*^9, 
   3.709118436970706*^9}, {3.709123748397312*^9, 3.709123749898518*^9}, 
   3.7094728947811785`*^9, {3.709637206023689*^9, 3.709637214399168*^9}, {
   3.7097687730730247`*^9, 3.7097687752414284`*^9}, {3.7149218447457066`*^9, 
   3.7149218497289915`*^9}, {3.7155234590260606`*^9, 
   3.7155234787291875`*^9}, {3.7255595371350355`*^9, 
   3.7255595430786457`*^9}, {3.7255596310784006`*^9, 
   3.7255596328724036`*^9}, {3.72658413248254*^9, 3.726584139786271*^9}, 
   3.726584174443736*^9, {3.7265850918114634`*^9, 3.7265850955478373`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dx", "=", "0"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"data", " ", "file", " ", "index"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"V", "=", "0"}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     OverscriptBox["V", "_"], ":", " ", 
     RowBox[{"mean", " ", "vaccination", " ", "rate"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"delV", "=", "0"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"\[CapitalDelta]V", ":", " ", 
    RowBox[{"vaccination", " ", "rate", " ", "differential"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rVH", "=", 
    RowBox[{"V", "+", "delV"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    StyleBox[
     SubsuperscriptBox["\[Pi]", "H", "V"],
     FontSlant->"Italic"], ":", " ", 
    RowBox[{
     RowBox[{
     "rate", " ", "of", " ", "vaccination", " ", "in", " ", "the", " ", 
      "high"}], "-", 
     RowBox[{"vaxx", " ", "region"}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rVL", "=", 
   RowBox[{"V", "-", "delV"}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    StyleBox[
     SubsuperscriptBox["\[Pi]", "L", "V"],
     FontSlant->"Italic"], ":", " ", 
    RowBox[{
     RowBox[{
     "rate", " ", "of", " ", "vaccination", " ", "in", " ", "the", " ", 
      "low"}], "-", 
     RowBox[{"vaxx", " ", "region"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]"}]}], "Input",
 CellChangeTimes->{{3.7094738480981784`*^9, 3.709473875277191*^9}, {
  3.7095596122626443`*^9, 3.709559612529251*^9}, {3.7095666746772456`*^9, 
  3.709566675020446*^9}, {3.709637259175729*^9, 3.7096372728955135`*^9}, {
  3.7097688079390855`*^9, 3.709768809967089*^9}, {3.7149218548022814`*^9, 
  3.714921896593672*^9}, {3.7155233417853546`*^9, 3.7155234450012584`*^9}, {
  3.715523482665413*^9, 3.7155234928579955`*^9}, {3.725559548725856*^9, 
  3.7255595708154945`*^9}, {3.726584190613353*^9, 3.7265843319944897`*^9}, {
  3.726584391645454*^9, 3.726584392165506*^9}, {3.7265844795692453`*^9, 
  3.726584508642153*^9}, {3.727629206536649*^9, 3.7276292157526493`*^9}, {
  3.7276293153316493`*^9, 3.7276293547596493`*^9}, {3.7276293954376493`*^9, 
  3.727629437523649*^9}}],

Cell[CellGroupData[{

Cell["Infection characteristics", "Subsection",
 CellChangeTimes->{{3.664030505555173*^9, 3.6640305089875164`*^9}, 
   3.7017745772142*^9, {3.709118149985917*^9, 3.70911815440117*^9}, {
   3.7091244245239005`*^9, 3.709124431642923*^9}, {3.7091245944560385`*^9, 
   3.709124597070446*^9}, {3.709125404935969*^9, 3.7091254052177696`*^9}, {
   3.709473002207178*^9, 3.7094730337491784`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"S", "=", "100"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"number", " ", "of", " ", "seasons"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beta", "=", "0.02"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"\[Beta]", ":", " ", 
    RowBox[{"infection", " ", "probability"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"tauE", "=", "2"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"length", " ", "of", " ", "the", " ", "latent", " ", "period"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"tauI", "=", "7"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "length", " ", "of", " ", "the", " ", "infectious", " ", "period"}], " ", 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7091246248945284`*^9, 3.709124629147741*^9}, {
   3.709130409871402*^9, 3.7091304159078193`*^9}, {3.709196626516675*^9, 
   3.709196634923156*^9}, {3.7091994609157934`*^9, 3.709199476267671*^9}, {
   3.7091995213882523`*^9, 3.709199522683326*^9}, {3.709205542237625*^9, 
   3.7092055435967026`*^9}, {3.709205595164652*^9, 3.709205595427667*^9}, 
   3.7092056418853245`*^9, {3.70920567782838*^9, 3.709205697708517*^9}, {
   3.709205741909045*^9, 3.7092057421880617`*^9}, {3.709205789220752*^9, 
   3.709205789491767*^9}, {3.709205893908739*^9, 3.7092059107967052`*^9}, {
   3.7092060911730223`*^9, 3.709206091500041*^9}, {3.7092341447242584`*^9, 
   3.709234148623287*^9}, 3.709234220681862*^9, {3.7265843690041904`*^9, 
   3.7265844720004888`*^9}, 3.727629153605649*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Contagion dynamics", "Subsection",
 CellChangeTimes->{{3.664030505555173*^9, 3.6640305089875164`*^9}, 
   3.7017745772142*^9, {3.709118149985917*^9, 3.70911815440117*^9}, {
   3.7091244245239005`*^9, 3.709124431642923*^9}, {3.7091246767984924`*^9, 
   3.709124713729413*^9}, {3.7091247464617105`*^9, 3.7091247655945683`*^9}, {
   3.7091251820868607`*^9, 3.7091251881866784`*^9}, {3.7091254082065773`*^9, 
   3.7091254084027786`*^9}, {3.709545654085153*^9, 3.7095456641811624`*^9}}],

Cell["\<\
state[s, t, i]: infection state of agent i in period t of season s
\t= 0 if vaccinated and immune\t\t(V, R);
\t= 1 if unvaccinated and susceptible\t(NV, S);
\t= 2 if unvaccinated and exposed\t\t(NV, E);
\t= 3 if unvaccinated and infectious\t\t(NV, I);
\t= 4 if unvaccinated and recovered\t\t(NV, R);\
\>", "Text",
 CellChangeTimes->{{3.709124813540738*^9, 3.709125112901657*^9}, {
  3.709125215506361*^9, 3.709125281567568*^9}, {3.709132335075508*^9, 
  3.7091323355875373`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"stInt", "=", 
   RowBox[{"{", "}"}]}], ";", " ", 
  RowBox[{"stFin", "=", 
   RowBox[{"{", "}"}]}], ";", " ", 
  RowBox[{"contactN", "=", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.716111588070546*^9, 3.716111622854535*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"contact", " ", "network"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SeedRandom", "[", "s", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"contact", "[", 
      RowBox[{"netSize", ",", "pC"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"comNet", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"UndirectedEdge", "[", 
            RowBox[{"i", ",", "#"}], "]"}], "&"}], ",", 
          RowBox[{"cntA", "[", "i", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{
           RowBox[{"X", "*", "Y"}], "-", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dirNet", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"i", "\[Rule]", "#"}], "&"}], ",", 
          RowBox[{"cntA", "[", "i", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{
           RowBox[{"X", "*", "Y"}], "-", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"pl", "[", "s", "]"}], "=", 
      RowBox[{
       RowBox[{"MeanGraphDistance", "[", 
        RowBox[{"Flatten", "[", "dirNet", "]"}], "]"}], "//", "N"}]}], ";", 
     " ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "compute", " ", "the", " ", "mean", " ", "path", " ", "length"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", "epidemic", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"SeedRandom", "[", "s", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"t", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"y", "[", "k", "]"}], "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"agentHub", "[", "k", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", "5"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"RandomChoice", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"rVH", ",", 
               RowBox[{"1", "-", "rVH"}]}], "}"}], "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"RandomChoice", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"rVL", ",", 
               RowBox[{"1", "-", "rVL"}]}], "}"}], "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "0", ",", 
         RowBox[{
          RowBox[{"X", "*", "Y"}], "-", "1"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"init", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"y", "[", "k", "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "0", ",", 
           RowBox[{
            RowBox[{"X", "*", "Y"}], "-", "1"}]}], "}"}]}], "]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"seed", "=", 
      RowBox[{"RandomSample", "[", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"init", ",", "1"}], "]"}], ",", "nseed"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"state", "[", 
       RowBox[{"s", ",", "t"}], "]"}], "=", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{"init", ",", 
        RowBox[{"seed", "\[Rule]", "2"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tinf", "=", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"X", "*", "Y"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"seed", "\[Rule]", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"stemp", "=", 
      RowBox[{"state", "[", 
       RowBox[{"s", ",", "t"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"numV", "[", 
       RowBox[{"s", ",", "t"}], "]"}], "=", 
      RowBox[{"Count", "[", 
       RowBox[{"stemp", ",", "0"}], "]"}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "number", " ", "of", " ", "vaccinated", " ", "agents", " ", "in", " ", 
       "t"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"numS", "[", 
       RowBox[{"s", ",", "t"}], "]"}], "=", 
      RowBox[{"Count", "[", 
       RowBox[{"stemp", ",", "1"}], "]"}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "number", " ", "of", " ", "susceptible", " ", "agents", " ", "in", " ", 
       "t"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"numE", "[", 
       RowBox[{"s", ",", "t"}], "]"}], "=", 
      RowBox[{"Count", "[", 
       RowBox[{"stemp", ",", "2"}], "]"}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "number", " ", "of", " ", "exposed", " ", "agents", " ", "in", " ", 
       "t"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"numI", "[", 
       RowBox[{"s", ",", "t"}], "]"}], "=", 
      RowBox[{"Count", "[", 
       RowBox[{"stemp", ",", "3"}], "]"}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "number", " ", "of", " ", "infectious", " ", "agents", " ", "in", " ", 
       "t"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"numR", "[", 
       RowBox[{"s", ",", "t"}], "]"}], "=", 
      RowBox[{"Count", "[", 
       RowBox[{"stemp", ",", "4"}], "]"}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "number", " ", "of", " ", "recovered", " ", "agents", " ", "in", " ", 
       "t"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"t", "=", 
      RowBox[{"t", "+", "1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"numE", "[", 
          RowBox[{"s", ",", 
           RowBox[{"t", "-", "1"}]}], "]"}], ">", "0"}], "||", 
        RowBox[{
         RowBox[{"numI", "[", 
          RowBox[{"s", ",", 
           RowBox[{"t", "-", "1"}]}], "]"}], ">", "0"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"q", "[", 
          RowBox[{"s", ",", "t"}], "]"}], "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"1", "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "beta"}], ")"}], "^", 
             RowBox[{"Count", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"state", "[", 
                 RowBox[{"s", ",", 
                  RowBox[{"t", "-", "1"}]}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"cntA", "[", "i", "]"}], "+", "1"}], "]"}], "]"}], 
               ",", "3"}], "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", 
             RowBox[{
              RowBox[{"X", "*", "Y"}], "-", "1"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"randQ", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"RandomReal", "[", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"X", "*", "Y"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"infected", "=", 
         RowBox[{"Intersection", "[", 
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"state", "[", 
              RowBox[{"s", ",", 
               RowBox[{"t", "-", "1"}]}], "]"}], ",", "1"}], "]"}], ",", 
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"randQ", "-", 
              RowBox[{"q", "[", 
               RowBox[{"s", ",", "t"}], "]"}]}], ",", 
             RowBox[{"n_", "/;", 
              RowBox[{"n", "\[LessEqual]", "0"}]}]}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"stemp", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"stemp", ",", 
           RowBox[{"infected", "\[Rule]", "2"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tinf", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"tinf", ",", 
           RowBox[{"infected", "\[Rule]", "t"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"infectious", "=", 
         RowBox[{"Intersection", "[", 
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"state", "[", 
              RowBox[{"s", ",", 
               RowBox[{"t", "-", "1"}]}], "]"}], ",", "2"}], "]"}], ",", 
           RowBox[{"Position", "[", 
            RowBox[{"tinf", ",", 
             RowBox[{"n_", "/;", 
              RowBox[{"n", ">", "0"}]}]}], "]"}], ",", 
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"t", "-", "tinf"}], ",", 
             RowBox[{"n_", "/;", 
              RowBox[{"n", "\[GreaterEqual]", "tauE"}]}]}], "]"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"stemp", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"stemp", ",", 
           RowBox[{"infectious", "\[Rule]", "3"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"recovered", "=", 
         RowBox[{"Intersection", "[", 
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"state", "[", 
              RowBox[{"s", ",", 
               RowBox[{"t", "-", "1"}]}], "]"}], ",", "3"}], "]"}], ",", 
           RowBox[{"Position", "[", 
            RowBox[{"tinf", ",", 
             RowBox[{"n_", "/;", 
              RowBox[{"n", ">", "0"}]}]}], "]"}], ",", 
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"t", "-", "tinf"}], ",", 
             RowBox[{"n_", "/;", 
              RowBox[{"n", "\[GreaterEqual]", 
               RowBox[{"tauE", "+", "tauI"}]}]}]}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"stemp", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"stemp", ",", 
           RowBox[{"recovered", "\[Rule]", "4"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"numV", "[", 
          RowBox[{"s", ",", "t"}], "]"}], "=", 
         RowBox[{"Count", "[", 
          RowBox[{"stemp", ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"numS", "[", 
          RowBox[{"s", ",", "t"}], "]"}], "=", 
         RowBox[{"Count", "[", 
          RowBox[{"stemp", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"numE", "[", 
          RowBox[{"s", ",", "t"}], "]"}], "=", 
         RowBox[{"Count", "[", 
          RowBox[{"stemp", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"numI", "[", 
          RowBox[{"s", ",", "t"}], "]"}], "=", 
         RowBox[{"Count", "[", 
          RowBox[{"stemp", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"numR", "[", 
          RowBox[{"s", ",", "t"}], "]"}], "=", 
         RowBox[{"Count", "[", 
          RowBox[{"stemp", ",", "4"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"state", "[", 
          RowBox[{"s", ",", "t"}], "]"}], "=", "stemp"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"t", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"final", "[", "s", "]"}], "=", 
      RowBox[{"t", "-", "1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"save", " ", "state", " ", "and", " ", "network", " ", "data"}],
       " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"stInt", "=", 
      RowBox[{"Append", "[", 
       RowBox[{"stInt", ",", 
        RowBox[{"state", "[", 
         RowBox[{"s", ",", "1"}], "]"}]}], "]"}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "initial", " ", "state", " ", "of", " ", "the", " ", "population", " ",
         "in", " ", "t"}], "=", "1"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"stFin", "=", 
      RowBox[{"Append", "[", 
       RowBox[{"stFin", ",", 
        RowBox[{"state", "[", 
         RowBox[{"s", ",", 
          RowBox[{"final", "[", "s", "]"}]}], "]"}]}], "]"}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "final", " ", "state", " ", "of", " ", "the", " ", "population", " ", 
       "at", " ", "the", " ", "end", " ", "of", " ", "epidemic"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"contactN", "=", 
      RowBox[{"Append", "[", 
       RowBox[{"contactN", ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"cntA", "[", "i", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", 
            RowBox[{
             RowBox[{"X", "*", "Y"}], "-", "1"}]}], "}"}]}], "]"}]}], "]"}]}],
      ";"}], " ", 
    RowBox[{"(*", " ", 
     RowBox[{"contact", " ", "networks", " ", "for", " ", "population"}], " ",
      "*)"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"s", ",", "1", ",", "S"}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{
  3.709201259228651*^9, {3.709201323452324*^9, 3.7092013371821094`*^9}, {
   3.709201406740088*^9, 3.7092014601801443`*^9}, {3.7092015371565475`*^9, 
   3.709201623603492*^9}, {3.7092017145486937`*^9, 3.709201737524008*^9}, {
   3.709201799075528*^9, 3.7092018574358664`*^9}, 3.7092019566605415`*^9, {
   3.709202320933377*^9, 3.7092023393484297`*^9}, {3.7092023758605185`*^9, 
   3.7092023778526325`*^9}, {3.7092025190687094`*^9, 
   3.7092025228259244`*^9}, {3.709202745828679*^9, 3.709202747739789*^9}, {
   3.7092027875500655`*^9, 3.7092027969186015`*^9}, {3.709202870707822*^9, 
   3.7092029453720927`*^9}, {3.709202982404211*^9, 3.709203044843782*^9}, {
   3.70920313659603*^9, 3.709203156636176*^9}, {3.709203345508979*^9, 
   3.7092034275736732`*^9}, {3.7092035582211456`*^9, 
   3.7092035607322893`*^9}, {3.7092036470372257`*^9, 3.709203648476308*^9}, {
   3.7092041685400543`*^9, 3.7092042456044617`*^9}, {3.709204353110611*^9, 
   3.709204355438744*^9}, {3.7092051221625977`*^9, 3.7092051797498918`*^9}, {
   3.7092052342620096`*^9, 3.7092053018068733`*^9}, {3.7092062138790407`*^9, 
   3.709206271789353*^9}, {3.709208480847704*^9, 3.7092084831898375`*^9}, {
   3.709233445121846*^9, 3.7092334824531155`*^9}, 3.709233902721369*^9, {
   3.709234276003318*^9, 3.7092342761933184`*^9}, {3.7094730719731784`*^9, 
   3.709473084212178*^9}, {3.709637125585088*^9, 3.7096371310193987`*^9}, 
   3.709637165864392*^9, {3.7096373277126493`*^9, 3.7096374434312677`*^9}, {
   3.709637511433157*^9, 3.7096375125932236`*^9}, {3.7097676163093925`*^9, 
   3.7097676946059303`*^9}, {3.70976772861399*^9, 3.7097677467880216`*^9}, 
   3.70976872491574*^9, {3.7149209158665776`*^9, 3.7149209607061424`*^9}, {
   3.7149210028445525`*^9, 3.7149210125781093`*^9}, {3.714921046522051*^9, 
   3.714921048386157*^9}, {3.714921166994941*^9, 3.71492120386705*^9}, {
   3.7149213264990644`*^9, 3.714921329131215*^9}, {3.714921599771695*^9, 
   3.7149216057150345`*^9}, 3.7155231123862343`*^9, {3.715523145577132*^9, 
   3.7155231970350757`*^9}, {3.7161127519041133`*^9, 3.716112889184965*^9}, 
   3.7161359011623135`*^9, {3.716191972293399*^9, 3.7161919805568714`*^9}, {
   3.7265843565009403`*^9, 3.72658435799809*^9}, {3.7265845669179797`*^9, 
   3.7265845808553734`*^9}, {3.7265846244727345`*^9, 
   3.7265847259168777`*^9}, {3.726584776222908*^9, 3.7265849019574804`*^9}, {
   3.726588761514435*^9, 3.7265887775960426`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Export the simulation output", "Section",
 CellChangeTimes->{{3.664030505555173*^9, 3.6640305089875164`*^9}, 
   3.7017745772142*^9, {3.709118149985917*^9, 3.70911815440117*^9}, {
   3.7091244245239005`*^9, 3.709124431642923*^9}, {3.7091246767984924`*^9, 
   3.709124713729413*^9}, {3.7091247464617105`*^9, 3.7091247655945683`*^9}, {
   3.7091251820868607`*^9, 3.7091251881866784`*^9}, {3.7091254082065773`*^9, 
   3.7091254084027786`*^9}, {3.709545654085153*^9, 3.7095456641811624`*^9}, {
   3.7265850044157248`*^9, 3.7265850213604193`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vx", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"numV", "[", 
        RowBox[{"k", ",", "i"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"final", "[", "k", "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "100"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sx", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"numS", "[", 
        RowBox[{"k", ",", "i"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"final", "[", "k", "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "100"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ex", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"numE", "[", 
        RowBox[{"k", ",", "i"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"final", "[", "k", "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "100"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ix", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"numI", "[", 
        RowBox[{"k", ",", "i"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"final", "[", "k", "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "100"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rx", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"numR", "[", 
        RowBox[{"k", ",", "i"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"final", "[", "k", "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "100"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7092048692161303`*^9, 3.709204883931972*^9}, {
  3.709205346710441*^9, 3.7092053480535183`*^9}, {3.7092053921500406`*^9, 
  3.709205398556407*^9}, {3.7092083887404356`*^9, 3.70920839458877*^9}, {
  3.7092088919062004`*^9, 3.709208960784322*^9}, {3.709233924943536*^9, 
  3.709233936333618*^9}, {3.7092404133322554`*^9, 3.7092404264518785`*^9}, {
  3.714921238625038*^9, 3.714921250825736*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"\"\<dataZ\>\"", "<>", 
     RowBox[{"ToString", "[", "dx", "]"}], "<>", "\"\</final.dat\>\""}], ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"final", "[", "i", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "100"}], "}"}]}], "]"}], ",", 
    "\"\<WDX\>\""}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"\"\<dataZ\>\"", "<>", 
     RowBox[{"ToString", "[", "dx", "]"}], "<>", "\"\</pl.dat\>\""}], ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"pl", "[", "i", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "100"}], "}"}]}], "]"}], ",", 
    "\"\<WDX\>\""}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"\"\<dataZ\>\"", "<>", 
     RowBox[{"ToString", "[", "dx", "]"}], "<>", "\"\</vx.dat\>\""}], ",", 
    "vx", ",", "\"\<WDX\>\""}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"\"\<dataZ\>\"", "<>", 
     RowBox[{"ToString", "[", "dx", "]"}], "<>", "\"\</sx.dat\>\""}], ",", 
    "sx", ",", "\"\<WDX\>\""}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"\"\<dataZ\>\"", "<>", 
     RowBox[{"ToString", "[", "dx", "]"}], "<>", "\"\</ex.dat\>\""}], ",", 
    "ex", ",", "\"\<WDX\>\""}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"\"\<dataZ\>\"", "<>", 
     RowBox[{"ToString", "[", "dx", "]"}], "<>", "\"\</ix.dat\>\""}], ",", 
    "ix", ",", "\"\<WDX\>\""}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"\"\<dataZ\>\"", "<>", 
     RowBox[{"ToString", "[", "dx", "]"}], "<>", "\"\</rx.dat\>\""}], ",", 
    "rx", ",", "\"\<WDX\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"\"\<dataZ\>\"", "<>", 
     RowBox[{"ToString", "[", "dx", "]"}], "<>", "\"\</stInt.dat\>\""}], ",", 
    "stInt", ",", "\"\<WDX\>\""}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"\"\<dataZ\>\"", "<>", 
     RowBox[{"ToString", "[", "dx", "]"}], "<>", "\"\</stFin.dat\>\""}], ",", 
    "stFin", ",", "\"\<WDX\>\""}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"\"\<dataZ\>\"", "<>", 
     RowBox[{"ToString", "[", "dx", "]"}], "<>", "\"\</contactN.dat\>\""}], 
    ",", "contactN", ",", "\"\<WDX\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.709323064286439*^9, 3.7093231410448294`*^9}, {
   3.709323187293474*^9, 3.709323280356797*^9}, 3.7093233966544495`*^9, 
   3.7094731442231784`*^9, {3.7094737916721783`*^9, 3.7094738214131784`*^9}, {
   3.7096375347204895`*^9, 3.709637549559338*^9}, {3.709637580166088*^9, 
   3.7096375925437965`*^9}, {3.7097684245362124`*^9, 3.709768424551812*^9}, {
   3.714921272157956*^9, 3.714921280889456*^9}, {3.714930548578537*^9, 
   3.714930571857869*^9}, {3.7155236316799355`*^9, 3.7155236316869364`*^9}, {
   3.715539255475755*^9, 3.715539255485756*^9}, {3.7155512568541946`*^9, 
   3.7155512568631954`*^9}, {3.715551539777377*^9, 3.715551539784377*^9}, {
   3.715611509800458*^9, 3.715611509800458*^9}, {3.7161129096701365`*^9, 
   3.7161130921025715`*^9}, {3.716113273575951*^9, 3.716113273592952*^9}, {
   3.725438364837454*^9, 3.7254383648530536`*^9}, {3.725468316407365*^9, 
   3.725468316422965*^9}, {3.725507743264428*^9, 3.7255077432800283`*^9}, {
   3.7255296608317327`*^9, 3.725529660847333*^9}, {3.7255600134234724`*^9, 
   3.7255600134234724`*^9}, {3.7265850556988525`*^9, 3.726585061426426*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1280, 721},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
PrintingCopies->1,
PrintingStartingPageNumber->1,
PrintingPageRange->{32000, 32000},
PageHeaders->{{
   Cell[
    TextData[{
      StyleBox[
       CounterBox["Page"], "PageNumber"], "   ", "|", " ", 
      StyleBox[
       ValueBox["FileName"], "Header"]}], "Header", 
    CellMargins -> {{0, Inherited}, {Inherited, Inherited}}], None, None}, {
  None, None, 
   Cell[
    TextData[{
      StyleBox[
       ValueBox["FileName"], "Header"], " ", "|", "   ", 
      StyleBox[
       CounterBox["Page"], "PageNumber"]}], "Header", 
    CellMargins -> {{Inherited, 0}, {Inherited, Inherited}}]}},
PageFooters->{{
   Cell[
    TextData[
     StyleBox[
      ValueBox["Date"], TaggingRules -> {"Date", 1}]], "Footer", 
    CellMargins -> {{0, Inherited}, {Inherited, Inherited}}], None, 
   Cell[
    TextData[{"Myong", "-", "Hun", " ", "Chang"}], "Footer", 
    CellMargins -> {{Inherited, 0}, {Inherited, Inherited}}]}, {
   Cell[
    TextData[{"Myong", "-", "Hun", " ", "Chang"}], "Footer", 
    CellMargins -> {{0, Inherited}, {Inherited, Inherited}}], None, 
   Cell[
    TextData[
     StyleBox[
      ValueBox["Date"], TaggingRules -> {"Date", 1}]], "Footer", 
    CellMargins -> {{Inherited, 0}, {Inherited, Inherited}}]}},
PageHeaderLines->{True, True},
PageFooterLines->{True, True},
PrintingOptions->{"FacingPages"->True,
"FirstPageFace"->Right,
"FirstPageFooter"->True,
"FirstPageHeader"->True,
"Magnification"->1.,
"PaperOrientation"->"Portrait",
"PaperSize"->{792, 612},
"PrintingMargins"->{{54, 54}, {72, 72}}},
FrontEndVersion->"10.4 for Microsoft Windows (64-bit) (April 11, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 565, 9, 72, "Chapter"],
Cell[1148, 33, 432, 6, 46, "Text"],
Cell[1583, 41, 420, 5, 49, "Text"],
Cell[CellGroupData[{
Cell[2028, 50, 96, 1, 70, "Section"],
Cell[CellGroupData[{
Cell[2149, 55, 133, 2, 31, "Input"],
Cell[2285, 59, 651, 9, 31, "Output"]
}, Open  ]],
Cell[2951, 71, 123, 3, 31, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3111, 79, 28, 0, 70, "Section"],
Cell[CellGroupData[{
Cell[3164, 83, 52, 0, 49, "Subsection"],
Cell[3219, 85, 1444, 39, 153, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4700, 129, 116, 1, 49, "Subsection"],
Cell[4819, 132, 2535, 68, 288, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7391, 205, 160, 2, 49, "Subsection"],
Cell[7554, 209, 5173, 127, 468, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[12776, 342, 99, 1, 70, "Section"],
Cell[12878, 345, 1307, 22, 31, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14222, 372, 269, 3, 70, "Section"],
Cell[14494, 377, 368, 8, 31, "Input"],
Cell[14865, 387, 386, 9, 31, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15288, 401, 708, 10, 70, "Section"],
Cell[15999, 413, 2263, 59, 132, "Input"],
Cell[CellGroupData[{
Cell[18287, 476, 388, 5, 49, "Subsection"],
Cell[18678, 483, 1541, 32, 92, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20256, 520, 487, 6, 49, "Subsection"],
Cell[20746, 528, 489, 10, 125, "Text"],
Cell[21238, 540, 281, 8, 31, "Input"],
Cell[21522, 550, 15958, 391, 992, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[37529, 947, 548, 7, 70, "Section"],
Cell[38080, 956, 2554, 75, 112, "Input"],
Cell[40637, 1033, 3639, 85, 212, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

